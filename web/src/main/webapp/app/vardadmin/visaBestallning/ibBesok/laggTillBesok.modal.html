<div id="lagg-till-besok-modal">
  <div class="modal-header">
    <button class="close" data-dismiss="modal" data-ng-click="$dismiss()"><i class="material-icons">close</i></button>
    <h4 class="modal-title">Lägg till besök</h4>
  </div>
  <div class="modal-body">
    <ib-alert-message ng-if="besok.profession && besok.profession !== 'LK'" alert-id="lagg-till-besok.info.profession"
                      alert-message-id="lagg-till-besok.info.profession" alert-severity="info"></ib-alert-message>
    <ib-alert-message ng-if="showMessageForKallelse()" alert-id="lagg-till-besok.info.profession" alert-severity="info">
      {{ getMessageForKallelsedatum() }}
    </ib-alert-message>

    <form name="laggTillBesokForm" novalidate autocomplete="off">
      <div class="flex-column">
        <div class="flex-row">
          <span class="date">
            <ib-help-text-label required="true" required-expr="!besokDatum"
                                label-key="lagg-till-besok.label.date"></ib-help-text-label>
            <ib-date-picker-field target-model="besokDatum" format="yyyy-MM-dd"
                                  date-format-error="Ogiltigt datumformat, ange ett datum som ÅÅÅÅ-MM-DD"
                                  ib-date-picker-field append-to-body="true" add-date-parser="strict"
                                  dom-id="dateBesokDatum" show-field-errors="false">
            </ib-date-picker-field>
          </span>
          <span class="time">
            <ib-help-text-label required="true" required-expr="!besokStartTid"
                                label-key="lagg-till-besok.label.from"></ib-help-text-label>
            <ib-time-picker data-date="besokStartTid" dom-id="dateBesokStart" required="false"
                            show-field-errors="false"></ib-time-picker>
          </span>
          <span class="time">
            <ib-help-text-label required="true" required-expr="!besokSlutTid"
                                label-key="lagg-till-besok.label.to"></ib-help-text-label>
            <ib-time-picker data-date="besokSlutTid" dom-id="dateBesokSlut" required="false"
                            show-field-errors="false"></ib-time-picker>
          </span>
        </div>
        <div class="flex-column">
          <ib-field-error-list errors="error" ng-repeat="error in [laggTillBesokForm.dateBesokDatum.$error,
                                  laggTillBesokForm.dateBesokStart.$error,
                                  laggTillBesokForm.dateBesokSlut.$error] track by $index"
                               ng-if="error.pattern || error.date"></ib-field-error-list>
        </div>
        <div class="flex-row">
          <span>
            <ib-help-text-label required="true" required-expr="!besok.profession"
                                label-key="lagg-till-besok.label.profession"></ib-help-text-label>
          </span>
          <ib-dropdown id="profession" ng-model="besok.profession" ng-change="onChange()"
                       items="professionList"></ib-dropdown>
        </div>
        <div class="flex-row">
          <span><ib-help-text-label label-key="lagg-till-besok.label.name"></ib-help-text-label></span>
          <span id="interpreter-input-field">
            <input class="form-control" type="text" ng-model="besok.utredandeVardPersonalNamn"
                   placeholder="Namn på utredande vårdpersonal">
          </span>
        </div>
        <div class="flex-row">
          <span><ib-help-text-label label-key="lagg-till-besok.label.interpreter"></ib-help-text-label></span>
          <span>
            <ib-checkbox-wrapper>
              <input type="checkbox" ng-model="besok.tolkStatus" ng-true-value="'BOKAT'" ng-false-value="">
              <label>{{}}</label>
            </ib-checkbox-wrapper>
          </span>
        </div>
        <div class="flex-row">
          <span class="kallelse">
            <ib-help-text-label required="true" required-expr="!besokKallelse"
                                label-key="lagg-till-besok.label.kallelseskickad"></ib-help-text-label>
          </span>
          <ib-date-picker-field target-model="besokKallelse"
                                min-date-error="Möjligt startdatum får tidigast vara dagens datum"
                                max-date-error="Möjligt kallelsedatum får inte vara efter besöksdatum"
                                max-date="{{ besokDatum }}" format="yyyy-MM-dd"
                                date-format-error="Ogiltigt datumformat, ange ett datum som ÅÅÅÅ-MM-DD"
                                ib-date-picker-field append-to-body="true" add-date-parser="strict"
                                dom-id="besokKallelseDatum" show-field-errors="false"></ib-date-picker-field>
          <ib-radio-wrapper>
            <input type="radio" value="BREVKONTAKT" ng-model="besok.kallelseForm">
            <label ng-click="besok.kallelseForm = 'BREVKONTAKT'" ng-attr-for="utforarTypEnhet">Per post</label>
          </ib-radio-wrapper>
          <ib-radio-wrapper>
            <input type="radio" value="TELEFONKONTAKT" ng-model="besok.kallelseForm">
            <label ng-click="besok.kallelseForm = 'TELEFONKONTAKT'" ng-attr-for="utforarTypUnderleverantor">Per
              telefon</label>
          </ib-radio-wrapper>
        </div>
        <div class="flex-column">
          <ib-field-error-list errors="laggTillBesokForm.besokKallelseDatum.$error"></ib-field-error-list>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <ib-alert-message ng-if="showReportErrorMessage" alert-message-id="lagg-till-besok.error.teknisktfel"
                      alert-id="lagg-till-besok.error.teknisktfel" alert-severity="danger"></ib-alert-message>
    <ib-alert-message ng-if="showUpdateAssessmentErrorMessage" alert-message-id="lagg-till-besok.error.teknisktfelafu"
                      alert-id="lagg-till-besok.error.teknisktfelafu" alert-severity="danger"></ib-alert-message>
    <ib-button btn-id="lagg-till-besok-modal-skicka" btn-class="btn-primary" ng-click="send()" busy="skickar"
            ng-disabled="!besokDatum || !besokStartTid || !besokSlutTid || !besok.profession || !besokKallelse">
      Spara
    </ib-button>
    <button type="button" id="lagg-till-besok-modal-cancel" class="btn btn-default" ng-click="$dismiss()">
      <span message key="common.cancel"></span>
    </button>
  </div>
</div>
