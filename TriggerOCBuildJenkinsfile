pipeline {
    agent any

    stages {
        stage('POST to trigger build in OC') {
            steps {
                writeFile file: "hook.yml", text: """git:
  uri: https://github.com/sklintyg/ib-backend.git
  ref: develop
env:
  - name: infraVersion
    value: $INFRA_VERSION
  - name: buildVersion
    value: $IB_BUILD_VERSION"""
                sh 'curl -k -X POST -H "Content-Type: application/yaml" --data-binary @hook.yml $BF_URL'
            }
        }
    }

    post {
        always {
            sh 'rm hook.json'
    }

}
